# no_a2l_demo Demo

## A2L Generation
  
Demonstrates options how to create an A2L file without the XCPlite typical runtime A2L creator code instrumentation.  

### xcp_client tool

The xcp_client tool from Rust xcp-lite can generate the A2L files.
The application must be running on the target.  
xcp_client can upload events and calibration segment information via XCP and create an A2L file template which exactly fits XCPlite capabilities.

Example:

```bash
$xcp_client   --dest-addr=$TARGET_HOST:5555 --tcp --create-a2l --a2l no_a2l_demo.a2l
```

Refer to the xcp_client command line parameter description for details.  

The A2L file template can now be modified, extended and updated with CANape or any other A2L tool.
This approach is limited to global measurement variables and calibration of parameters.  
XCPlite must be configured for absolute calibration segment addressing (OPTION_CAL_SEGMENTS_ABS).  

xcp_client has an additional experimental option to automatically generate content in the A2L file from debug information in an ELF file, based on static markers generated by the XCPlite code instrumentation.  
This enables measurement of local variables, class instances and heap.  

### Using Vector CANape

Drop the template into CANape and create a new XCP on Ethernet device.  
Eanable access to the ELF file in the device configuration.  
Use the A2L editor to add individual measurement parameters.  
For calibration just create an calibration instance for the complete calibration parameter struct.

### Using Vector A2L-Toolset

...

### Using Open Source a2ltool

Example:
Add the calibration segment 'params' and the measurment variable 'counter' to the A2L template:

```bash
a2ltool  --update --measurement-regex "counter"  --characteristic-regex "params" --elffile  no_a2l_demo.out  --enable-structures --output no_a2l_demo.out no_a2l_demo.out 
```

### Demo

The demo script create_a2l.sh automates the complete remote build and A2L generation process.

```bash
./create_a2l.sh
```

### Work in progress

This is currently experimental.  
The approach will be used for the upcoming ThreadX demo with build time A2L generation.

objdump -W no_a2l_demo.out
